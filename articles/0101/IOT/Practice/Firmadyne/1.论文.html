<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Firmadyne论文,Firmadyne论文</title>
    <link rel="stylesheet" href="/assets/css/notes.min.css">
</head>
<body>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>Firmadyne论文</h1>
<h2>一、网络仿真配置机制</h2>
<p>动态网络环境推断</p>
<p>系统通过两阶段仿真实现网络自动化配置：“通过实时网络交互监控，系统能够自动推断出符合实际设备行为的网络配置方案”</p>
<p><strong>学习阶段（60秒）:</strong></p>
<ul>
<li><strong>硬件配置</strong>：默认加载MIPS Malta/ARM Virtual Express平台外设</li>
<li><strong>网络监控项</strong>：
<ul>
<li>IP地址分配状态</li>
<li>IEEE 802.1d网桥创建过程</li>
<li>IEEE 802.1Q VLAN标记策略</li>
<li>以太网帧分离机制</li>
</ul>
</li>
</ul>
<p><strong>仿真阶段:</strong></p>
<ul>
<li><strong>TAP设备绑定</strong>：将主机TAP接口与固件LAN接口（如eth0）关联</li>
<li><strong>子网配置</strong>：设置与固件IP同网段的TAP地址</li>
<li><strong>VLAN隔离</strong>：根据学习数据配置虚拟局域网策略</li>
</ul>
<h2>二、NVRAM模拟关键技术</h2>
<blockquote>
<p>“在4,992个固件样本中，NVRAM访问错误是导致31.7%仿真失败的主要原因”</p>
</blockquote>
<h3>2.1 实现架构</h3>
<ol>
<li><strong>函数劫持</strong>：通过LD_PRELOAD拦截libnvram.so的nvram_get/set调用</li>
<li><strong>键值存储</strong>：在/var/nvram/建立临时文件系统作为持久化存储</li>
<li><strong>默认值加载</strong>：从/etc/nvram.default等文件提取初始配置</li>
</ol>
<h3>2.2 核心创新</h3>
<ul>
<li><strong>语义兼容</strong>：精确模拟52.6%固件使用的NVRAM硬件访问模式</li>
<li><strong>崩溃防护</strong>：返回空字符串替代NULL指针，避免strcpy等函数崩溃</li>
<li><strong>动态适配</strong>：支持不同C运行时库的延迟链接机制</li>
</ul>
<h2>三、内核级仿真优化</h2>
<p>内核增强功能:</p>
<ul>
<li>
<p><strong>系统调用监控</strong>：通过kprobes框架拦截20个关键调用,拦截改变执行环境的调用，包括分配 MAC 地址、创建网络桥接、重启系统、执行程序等操作，所有这些操作都由我们的框架监控以正确配置模拟的网络安全环境。此功能还可以用于提供自动确认漏洞，尤其是在与预定义的毒化值</p>
<ul>
<li>网络配置类：<code>setsockopt()</code>, <code>ioctl(SIOCSIFADDR)</code></li>
<li>系统管理类：<code>reboot()</code>, <code>execve()</code></li>
<li>硬件交互类：<code>mmap(/dev/mem)</code></li>
</ul>
</li>
<li>
<p><strong>虚拟设备支持</strong>：</p>
<ul>
<li>加载nandsim模块模拟MTD闪存访问</li>
<li>提前挂载/proc、/dev等虚拟文件系统</li>
</ul>
</li>
</ul>

        </main>
    </div>
</body>
</html>