<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Xpdf-CVE-2019-13288,Xpdf-CVE-2019-13288</title>
    <link rel="stylesheet" href="../../../assets/css/notes.min.css">
</head>
<body>
    <div id="header-placeholder"></div>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>Xpdf-CVE-2019-13288</h1>
<h2>1.漏洞简述</h2>
<p>在 Xpdf 4.01.01 中 <a href="http://Parser.cc">Parser.cc</a> 中的 Parser::getObj() 函数可能会通过精心设计的文件导致无限递归（没有正确控制发生的递归量，从而消耗了过多的资源，例如分配的内存或程序堆栈），远程攻击者可以利用它进行 DoS 攻击</p>
<h2>2.相关环境</h2>
<p>下载编译：</p>
<pre><code>wget https://dl.xpdfreader.com/old/xpdf-3.02.tar.gz
tar -xvzf xpdf-3.02.tar.gz
cd xpdf-3.02
sudo apt update &amp;&amp; sudo apt install -y build-essential gcc
./configure --prefix=&quot;/home/waiwai/fuzz/fuzzing101/exercise1/fuzzing_xpdf/install&quot;
make
make install
</code></pre>
<p>测试用例：</p>
<pre><code>mkdir pdf_examples &amp;&amp; cd pdf_examples
wget https://github.com/mozilla/pdf.js-sample-files/raw/master/helloworld.pdf
wget https://www.melbpc.org.au/wp-content/uploads/2017/10/small-example-pdf-file.pdf
</code></pre>
<p>AFL++安装：<a href="https://github.com/AFLplusplus/AFLplusplus/blob/stable/docs/INSTALL.md">https://github.com/AFLplusplus/AFLplusplus/blob/stable/docs/INSTALL.md</a></p>
<p>清除之前编译的目标文件和可执行文件：</p>
<pre><code class="language-shell">rm -r ./fuzzing_xpdf/install
cd ./fuzzing_xpdf/xpdf-3.02/
make clean
</code></pre>
<p>重新编译构建：</p>
<pre><code class="language-shell">export LLVM_CONFIG=&quot;llvm-config-18&quot;
CC=$HOME/tool/AFLplusplus/afl-clang-fast CXX=$HOME/tool/AFLplusplus/afl-clang-fast++ ./configure --prefix=/home/waiwai/fuzz/fuzzing101/exercise1/fuzzing_xpdf/install
make
make install
</code></pre>
<p>进行测试：<code>afl-fuzz -i $HOME/fuzz/fuzzing101/exercise1/fuzzing_xpdf/pdf_examples -o $HOME/fuzz/fuzzing101/exercise1/fuzzing_xpdf/out/ -s 123 -- $HOME/fuzz/fuzzing101/exercise1/fuzzing_xpdf/install/bin/pdftotext @@ $HOME/fuzz/fuzzing101/exercise1/fuzzing_xpdf/output</code>,等待崩溃后，可以在out目录下找到相关崩溃信息</p>
<p><img src="/0101/FUZZ/Fuzzing101/assets/1.Xpdf-CVE-2019-13288/image-20250303090624575.png" alt="image-20250303090624575"></p>
<h2>3.分析</h2>
<p>使用gdb调试文件，将crash的pdf文件作为参数输入，可以发现段崩溃了</p>
<p><img src="/0101/FUZZ/Fuzzing101/assets/1.Xpdf-CVE-2019-13288/image-20250304193237486.png" alt="image-20250304193237486"></p>
<p><code>bt</code>查看调用堆栈，可以发现一直在递归调用<code>Parser::getObj()</code></p>
<p><img src="/0101/FUZZ/Fuzzing101/assets/1.Xpdf-CVE-2019-13288/image-20250304193508440.png" alt="image-20250304193508440"></p>
<p>根据漏洞描述添加一个断点<code>b Parser::getObj</code>,一直<code>c</code>，那么调用链就可以很明显的出来了：</p>
<p><img src="/0101/FUZZ/Fuzzing101/assets/1.Xpdf-CVE-2019-13288/image-20250304194051715.png" alt="image-20250304194051715"></p>
<p>参考：<a href="https://www.ruanx.net/fuzzing101-wp-1/">https://www.ruanx.net/fuzzing101-wp-1/</a></p>

        </main>
    </div>
    <footer class="footer">
        <p>&copy; 2024 waiwai24. All rights reserved.</p>
    </footer>
    <script src="../../../assets/js/header.js"></script>
    <script src="../../../assets/js/include-header.js"></script>
</body>
</html>