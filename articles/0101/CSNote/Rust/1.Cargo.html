<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Cargo,Cargo</title>
    <link rel="stylesheet" href="/assets/css/notes.min.css">
</head>
<body>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>Cargo</h1>
<h2>1.基本介绍</h2>
<p>rust 安装：rustup</p>
<p>Cargo 是 Rust 的官方构建系统和包管理器。它主要有两个作用：</p>
<p>主要有两个作用：</p>
<ul>
<li><strong>项目管理</strong>：Cargo 用于创建、构建和管理 Rust 项目。通过 Cargo，你可以轻松地创建新项目，管理项目的依赖关系，并执行项目的构建、运行和测试等操作。</li>
<li><strong>包管理器</strong>：Cargo 还充当了 Rust 的包管理器。它允许开发者在项目中引入和管理依赖项（如第三方库），并确保这些依赖项的版本管理和兼容性。</li>
</ul>
<p>主要功能：</p>
<ul>
<li><strong>依赖管理</strong>：Cargo 通过 <code>Cargo.toml</code> 文件管理项目的依赖，这个文件列出了项目所需的所有外部库以及它们的版本。</li>
<li><strong>构建系统</strong>：Cargo 使用 Rust 编译器（rustc）来构建项目，它会自动处理依赖的编译和链接。</li>
<li><strong>构建配置</strong>：通过 <code>Cargo.toml</code> 和 <code>Cargo.lock</code> 文件，Cargo 允许开发者配置构建选项，如编译器选项、特性（features）和目标平台。</li>
<li><strong>项目模板</strong>：Cargo 提供了创建新项目的模板，可以通过 <code>cargo new</code> 命令快速启动新项目。</li>
<li><strong>测试</strong>：Cargo 提供了一个简单的命令 <code>cargo test</code> 来运行项目的单元测试。</li>
<li><strong>发布</strong>：通过 <code>cargo publish</code> 命令，开发者可以将他们的库发布到 <a href="http://crates.io">crates.io</a> 上，供其他开发者使用。</li>
<li><strong>跨平台构建</strong>：Cargo 支持跨多个平台构建 Rust 程序，包括 Windows、macOS、Linux 以及各种嵌入式系统。</li>
</ul>
<h2>2.命令</h2>
<pre><code class="language-shell">cargo new &lt;project-name&gt;：创建一个新的 Rust 项目。
cargo build：编译当前项目。cargo build --release 用于发行
cargo run：编译并运行当前项目。
cargo check：检查当前项目的语法和类型错误。
cargo test：运行当前项目的单元测试。
cargo update：更新 Cargo.toml 中指定的依赖项到最新版本。
cargo --help：查看 Cargo 的帮助信息。
cargo publish：将 Rust 项目发布到 crates.io。
cargo clean：清理构建过程中生成的临时文件和目录。
</code></pre>
<h2>3.包</h2>
<p>Rust 有两种类型的包: 库包和二进制包，前者是我们经常使用的依赖包，用于被其它包所引入，而后者是一个应用服务，可以编译成二进制可执行文件进行运行</p>
<p><a href="https://crates.io/"><code>crates.io</code></a> 是 Rust 社区维护的中心化注册服务，用户可以在其中寻找和下载所需的包。对于 <code>cargo</code> 来说，默认就是从这里下载依赖。</p>
<p>下面我们来添加一个 <code>time</code> 依赖包，若你的 <code>Cargo.toml</code> 文件中没有 <code>[dependencies]</code> 部分，就手动添加一个，并添加目标包名和版本号:</p>
<pre><code class="language-toml">[dependencies]
time = &quot;0.1.12&quot;
</code></pre>
<p>一个典型的项目 <code>Package</code> 目录结构如下：</p>
<pre><code class="language-shell">.
├── Cargo.lock
├── Cargo.toml
├── src/
│   ├── lib.rs
│   ├── main.rs
│   └── bin/
│       ├── named-executable.rs
│       ├── another-executable.rs
│       └── multi-file-executable/
│           ├── main.rs
│           └── some_module.rs
├── benches/
│   ├── large-input.rs
│   └── multi-file-bench/
│       ├── main.rs
│       └── bench_module.rs
├── examples/
│   ├── simple.rs
│   └── multi-file-example/
│       ├── main.rs
│       └── ex_module.rs
└── tests/
    ├── some-integration-tests.rs
    └── multi-file-test/
        ├── main.rs
        └── test_module.rs
</code></pre>
<ul>
<li>这也是 <code>Cargo</code> 推荐的目录结构，解释如下：
<ul>
<li><code>Cargo.toml</code> 和 <code>Cargo.lock</code> 保存在 <code>package</code> 根目录下</li>
<li>源代码放在 <code>src</code> 目录下</li>
<li>默认的 <code>lib</code> 包根是 <code>src/lib.rs</code></li>
<li>默认的二进制包根是 src/main.rs，其它二进制包根放在 <code>src/bin/</code> 目录下</li>
<li>基准测试 benchmark 放在 <code>benches</code> 目录下</li>
<li>示例代码放在 <code>examples</code> 目录下</li>
<li>集成测试代码放在 <code>tests</code> 目录下</li>
</ul>
</li>
</ul>
<p><code>Cargo.toml</code> 和 <code>Cargo.lock</code> 是 <code>Cargo</code> 的两个元配置文件，但是它们拥有不同的目的:</p>
<ul>
<li>前者从用户的角度出发来描述项目信息和依赖管理，因此它是由用户来编写</li>
<li>后者包含了依赖的精确描述信息，它是由 <code>Cargo</code> 自行维护，因此不要去手动修改</li>
</ul>
<h2>4.Cargo.toml 配置文件</h2>
<p>opt-level 优化级别：</p>
<ul>
<li>0：没有优化</li>
<li>1：基本优化</li>
<li>2：一些优化</li>
<li>3：所有优化</li>
<li>“s”：针对二进制大小进行优化</li>
<li>“z”：针对二进制大小进行优化，但也关闭循环矢量化</li>
</ul>
<p>strip 选项指示 rustc 从二进制文件中剥离符号或调试信息，strip = true 相当于 strip = “symbols”。strip = false 相当于 strip = “none” 完全禁用 strip</p>
<pre><code class="language-toml">[profile.dev]
opt-level = 0
debug = true
split-debuginfo = 'packed'  # Platform-specific.
strip = &quot;none&quot;
debug-assertions = true
overflow-checks = true
lto = false
panic = 'unwind'
incremental = true
codegen-units = 256
rpath = false

[profile.release]
opt-level = 3
debug = false
split-debuginfo = 'packed'  # Platform-specific.
strip = true
debug-assertions = false
overflow-checks = false
lto = false
panic = 'abort'
incremental = false
codegen-units = 16
rpath = false
</code></pre>

        </main>
    </div>
</body>
</html>