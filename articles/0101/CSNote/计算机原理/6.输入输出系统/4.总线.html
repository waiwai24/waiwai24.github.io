<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># 总线,总线</title>
    <link rel="stylesheet" href="../../../../assets/css/notes.min.css">
</head>
<body>
    <div id="header-placeholder"></div>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>总线</h1>
<blockquote>
<p>计算机系统是由多个基本模块连接而成，通过总线连接</p>
</blockquote>
<h2>1.总线概述</h2>
<ul>
<li>
<p>定义：连接两个以上部件或设备的<strong>信息通路</strong>，是各个部件或设备的<strong>共享传输介质</strong></p>
</li>
<li>
<p>特点：</p>
<ul>
<li>低成本：一组线路能被多种设备共享</li>
<li>多功能性：易于添加新设备</li>
</ul>
</li>
<li>
<p>分类：</p>
<ul>
<li>芯片内总线</li>
<li>通信总线</li>
<li>系统总线</li>
</ul>
</li>
<li>
<p>信号线类型：</p>
<ul>
<li>专用信号线：信号线专用来传送某一种信息，使用分立的数据线和地址线</li>
<li>复用信号线：信号线在不同的时间传输不同的信息，数据/地址线分时复用，优点在与减少总线条数，减小体积降低成本，缺点在于总线模块的电路变复杂，且不能并行</li>
</ul>
</li>
<li>
<p>信息传输方式：串行，并行</p>
</li>
<li>
<p>事务类型：数据传输类型或其他总线操作类型</p>
<ul>
<li>MEM R/W</li>
<li>IO R/W</li>
<li>中断响应</li>
</ul>
</li>
<li>
<p>性能受限于：总线长度，总线连接的设备数</p>
</li>
<li>
<p>总线带宽（单位时间内最大数据传输量）=总线宽度$\times$工作频率</p>
</li>
<li>
<p>仲裁方式：集中式，分布式</p>
</li>
</ul>
<h2>2.总线结构的分类</h2>
<h3>2.1 单总线结构</h3>
<blockquote>
<p>将CPU，MM和各种IO设配卡通过底板总线互连</p>
</blockquote>
<ul>
<li>多设备竞争总线</li>
<li>速度差异大的设备连接在一条总线，性能受限</li>
<li>扩展能力差</li>
</ul>
<h3>2.2 多总线结构</h3>
<blockquote>
<p>将CPU，cache，MM和各种IO适配卡通过局部总线，处理器-主存总线，高速IO总线等互连</p>
</blockquote>
<h2>3.系统总线的组成</h2>
<h3>3.1 数据线</h3>
<p>Data Bus：承载在源和目的部件之间传输信息，数据线的宽度反映了一次能够传送的数据的位数</p>
<h3>3.2 地址线</h3>
<p>Address Bus：给出源数据或目的数据所在的主存单元或IO接口的地址，地址线的宽度反映了最大寻址空间</p>
<h3>3.3 控制线</h3>
<p>Control Bus：控制对数据线和地址线的访问和使用，用来传输信号和命令信息，包括时钟，中断，存储器读写，IO读写等</p>
<h2>4.总线仲裁</h2>
<ul>
<li>概念：东多个设备需要使用总线进行通信时，采用某种策略选择一个设备使用总线</li>
<li>方法：在总线中引入一个或多个总线主设备，只有主设备才能控制总线
<ul>
<li>主设备：能发起总线请求并控制总线的设备，如处理器</li>
<li>从设备：只能响应从主设备发来的总线命令的设备，如主存</li>
</ul>
</li>
<li>通过总线仲裁来决定总线主设备将获得下次的总线使用权</li>
<li>总线仲裁信号：
<ul>
<li>总线请求线</li>
<li>总线允许线</li>
</ul>
</li>
<li>仲裁策略：
<ul>
<li><strong>等级性</strong>：高优先级的设备应该被先服务</li>
<li><strong>公平性</strong>：即时具有最低优先权的设备也不能永远得不到总线的使用权</li>
</ul>
</li>
</ul>
<h3>4.1 集中式仲裁</h3>
<p>将控制逻辑放在一个专门的总线控制器或仲裁器中，通过将所有的总线请求集中用一个特定的仲裁算法进行仲裁</p>
<h4>4.1.1 菊花链仲裁</h4>
<ul>
<li>从最高优先权的设备依次向最低优先权的设备串行相连，如果到达的设备有总线请求，信号就不再往下传了，该设备建立总线busy信号，表示它已经获得了总线的使用权</li>
<li>优点：简单，易于扩充设备</li>
<li>缺点：不呢保证公平性，限制了总线的性能，对电路故障很敏感</li>
</ul>
<h4>4.1.2 计数器定时查询仲裁</h4>
<ul>
<li>
<p>假设总线仲裁器中计数初值为0，这时设备2、4都通过BR线发出请求，如果设备不忙既BS为0，计数器开始从0计数。并通过设备地址线查看该设备是否发出请求，如果是，则响应否则继续计数。这里设备0没有请求，继续计数直至2，</p>
<p>发现设备2有请求则响应，并将BS线设为1。</p>
<p>如果每次查询计数器都从0开始，那么毫无疑问设备优先级和链式查询一样。如果从中止点开始（如上例中下次查询计数器从2开始计数并查询），那么可以实现循环优先级。也可以用软件设置计数初值为k，那么设备k的优先级最高。</p>
</li>
<li>
<p>优点：灵活</p>
</li>
<li>
<p>缺点：需要增加一组设备线，总线设备控制逻辑复杂，需要对设备号进行译码比较等</p>
</li>
</ul>
<h4>4.1.3 独立请求方式仲裁</h4>
<ul>
<li>每个总线上的部件都可以请求，但是由总线控制器按⼀定优先次序决定批准某个部件使⽤</li>
<li>优点：响应速度块，优先级灵活</li>
<li>缺点：控制逻辑复杂，控制线数多</li>
</ul>
<h3>4.2 分布式仲裁</h3>
<p>没有专门的总线控制器，其逻辑控制分散在各个部件或设备中</p>
<h4>4.2.1 自举分布式仲裁</h4>
<ul>
<li>优先级固定，各个设备独立决定是否是最高优先级请求者，需请求总线设备在各自对应总线请求线上送出请求信号。在总线仲裁期间，每个设备将比自己优先级高的请求线上的信号取回分析</li>
</ul>
<h4>4.2.2 冲突检测方式仲裁</h4>
<ul>
<li>网络通信总线（CSMA，监听）</li>
</ul>
<h2>5.总线时序</h2>
<ul>
<li>
<p>用来定义总线事务中的每一步何时开始，何时结束</p>
</li>
<li>
<p>实现方式：</p>
<ul>
<li>
<p><strong>同步</strong>：用时钟来同步定时</p>
<ul>
<li>优点：控制逻辑少而速度快</li>
<li>缺点：所有设备在同一时钟速率下运行，以最慢的设备为准；由于时钟偏移问题，同步总线不能很长</li>
</ul>
</li>
<li>
<p><strong>异步</strong>：用握手信号定时，即应答的方式，只有当双方都同意时，发送者或接收者才会进入到下一步，协议通过一对附加的握手信号线来实现</p>
<ul>
<li>优点：灵活，课挂接到各种具有不同工作速度的设备</li>
<li>缺点：接口逻辑较为复杂，对噪声较为敏感（任何时候都可能接收到对方的应答信号）</li>
</ul>
</li>
<li>
<p><strong>半同步</strong>：同步+异步结合，通过上升沿时钟信号来解决噪声敏感问题</p>
</li>
<li>
<p><strong>拆分事务</strong>：从设备准备数据时，释放总线</p>
<ul>
<li>过程1：主设备获得总线使用权后，将请求事务的类型，地址及其他信息发送到总线，从设备记下这些信息，主设备发完信息后便立马释放总线，其他设备便可以使用总线</li>
<li>过程2：从设备收到主设备的信息后，按照要求准备数据，准备好后，从设备便请求使用总线，获得使用权后，将数据送到总线，主设备便可以接受</li>
<li>优点：系统效率改善</li>
<li>缺点：单独的事务响应时间变长，增加复杂性</li>
</ul>
</li>
<li>
<p>CPU-处理器总线都采用同步方式，IO总线采用半同步方式，memory总线采用拆分事务方式（可提高总线的有效带宽）</p>
</li>
</ul>
</li>
</ul>

        </main>
    </div>
    <footer class="footer">
        <p>&copy; 2024 waiwai24. All rights reserved.</p>
    </footer>
    <script src="../../../../assets/js/header.js"></script>
    <script src="../../../../assets/js/include-header.js"></script>
</body>
</html>