<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># 堆栈,堆栈</title>
    <link rel="stylesheet" href="../../../../assets/css/notes.min.css">
</head>
<body>
    <div id="header-placeholder"></div>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>堆栈</h1>
<h2>1.堆栈操作</h2>
<p>LIFO结构（后进先出，last in first out），在程序执行中，堆栈通常用于存储<strong>局部变量、函数参数、返回地址、寄存器值的临时保存区</strong>以及处理函数调用时的切换</p>
<p>注意：栈在内存中是向下生长的</p>
<h2>2.运行时的堆栈（32位）</h2>
<ul>
<li>CPU用<code>ESP</code>(堆栈指针寄存器stack pointer register)对堆栈进行直接管理</li>
<li><code>ESP</code>寄存器中存放的是堆栈中某个位置的32位偏移量</li>
<li><code>ESP</code>寄存器不会被程序员直接修改控制，而是用**<code>call</code>,<code>ret</code>,<code>push</code>,<code>pop</code>**等指令间接修改的</li>
</ul>
<h3>2.1 入栈PUSH</h3>
<pre><code class="language-assembly">PUSH reg/mem16/mem32
PUSH imm32
</code></pre>
<p>32位入栈操作PUSH指令先把<code>ESP</code>减4，再把源操作数复制到栈顶指针指向的堆栈位置</p>
<h3>2.2 出栈POP</h3>
<pre><code class="language-assembly">POP reg/mem16/mem32
</code></pre>
<p>POP指令先把ESP指向的堆栈元素复制到一个16/32位目的操作数中，再从堆栈中删除数据，栈顶指针增加4</p>
<h3>2.3 PUSHFD，POPFD指令</h3>
<p>直接使用该指令不带参数，标识将32位EFLAGS寄存器内容压入/弹出栈</p>
<p>注意：MOV指令不能把标识寄存器内容赋值给一个变量</p>

        </main>
    </div>
    <footer class="footer">
        <p>&copy; 2024 waiwai24. All rights reserved.</p>
    </footer>
    <script src="../../../../assets/js/header.js"></script>
    <script src="../../../../assets/js/include-header.js"></script>
</body>
</html>