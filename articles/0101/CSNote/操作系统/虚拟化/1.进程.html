<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># 进程process,进程process</title>
    <link rel="stylesheet" href="/assets/css/notes.min.css">
</head>
<body>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>进程process</h1>
<h2>1.OS重要思想</h2>
<p><img src="/0101/CSNote/操作系统/虚拟化/assets/1.%E8%BF%9B%E7%A8%8B/image-20241127101438294.png" alt="image-20241127101438294"></p>
<p>资源共享：</p>
<ul>
<li>时分共享：每次由一个实体使用一小段时间</li>
<li>空分共享：每个实体同时使用一小部分资源</li>
</ul>
<p>典型应用：进程共享CPU</p>
<h2>2.基本概念</h2>
<p>进程基本概念：</p>
<ul>
<li><strong>进程是操作系统对运行程序的抽象</strong></li>
<li>操作系统每次选择一个进程在CPU上运行一段时间，利用时分共享的思想对CPU进行虚拟化</li>
</ul>
<p>多进程的引入：</p>
<ul>
<li>提升系统资源利用率，减少延迟，为多任务处理和调度创造条件</li>
<li>提升系统可靠性（避免单个进程出错影响系统）</li>
<li>简化编程模型</li>
</ul>
<h2>3.进程基础</h2>
<p>创建过程：</p>
<ul>
<li>代码和静态数据加载到进程的内存空间</li>
<li>为堆栈分配内存</li>
<li>操作系统执行一些其他初始化任务</li>
<li>运行程序，将CPU控制权转移到新创建的进程，进程以PID唯一标识</li>
</ul>
<p>状态：</p>
<ul>
<li>初始态：进程创建状态</li>
<li>运行态：正在运行</li>
<li>就绪态：可以运行，还未被调度</li>
<li>阻塞态：如进程发出IO操作请求</li>
<li>终止态：结束运行</li>
</ul>
<p><img src="/0101/CSNote/操作系统/虚拟化/assets/1.%E8%BF%9B%E7%A8%8B/image-20240822104628070.png" alt="image-20240822104628070"></p>
<p>控制进程运行的数据结构：进程控制块（PCB）</p>
<ul>
<li>进程标识信息（如pid等）</li>
<li>执行现场信息（CPU现场）</li>
<li>进程映像信息（地址空间）</li>
<li>进程资源信息</li>
<li>其他信息</li>
</ul>
<h2>4.进程的API</h2>
<p><code>fork()</code>创建进程</p>
<ul>
<li>在一个父进程中创建子进程（PID不同）</li>
<li>子进程得到父进程的资源拷贝，指令也一样，子进程获得父进程数据空间、堆和栈的复制，所以变量的地址（当然是虚拟地址）也是一样的</li>
<li>父子进程有独立的地址空间</li>
<li><strong>fork函数在父进程、子进程中都返回（一次调用两次返回）父子进程返回值不同，父进程返回值是子进程PID,子进程返回值是0</strong></li>
<li>父子进程的运行顺序/时间有差异，导致<strong>不确定性</strong></li>
</ul>
<p><code>wait()</code>用于等待任一子进程结束</p>
<ul>
<li>
<p>返回值：成功，返回子进程pid，若有错误返回-1</p>
<pre><code class="language-c">int wc = wait(NULL);
</code></pre>
</li>
</ul>
<p><code>exec()</code>将当前进程映像替换成新的程序文件并执行</p>
<ul>
<li>exec的成功调用不会返回</li>
<li>exec从可执行程序中加载代码和静态数据，覆盖自己的代码和静态数据，堆栈也会被重新初始化</li>
<li>子进程调用exec，从而执行和父进程不同的程序</li>
</ul>

        </main>
    </div>
</body>
</html>