<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># 地址转换,地址转换</title>
    <link rel="stylesheet" href="/assets/css/notes.min.css">
</head>
<body>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>地址转换</h1>
<h2>1.进程的地址空间</h2>
<p>OS 提供了一个物理内存的抽象：地址空间</p>
<ul>
<li>代码：存储指令</li>
<li>栈（向上增长）：局部变量、函数参数、返回值等</li>
<li>堆（向下增长）：动态分配的内存：malloc、new</li>
</ul>
<h2>2.内存相关的 API</h2>
<p>malloc()：</p>
<p>显示的申请内存</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
void* malloc(size_t size)
</code></pre>
<ul>
<li>size：申请空间的大小</li>
<li>返回值：成功返回分配成功内存指针，失败返回空指针</li>
</ul>
<p>free()：</p>
<p>释放内存</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
void* free(void* ptr)
</code></pre>
<ul>
<li>参数为调用 malloc 分配的指针（释放内存大小不是用户决定的）</li>
</ul>
<p>calloc():</p>
<p>在堆上申请内存空间，并且将其置 0, 可以防止忘记初始化分配的内存</p>
<pre><code class="language-c">void *calloc(size_t num, size_t size)
</code></pre>
<p>realloc():</p>
<p>重新分配内存</p>
<pre><code class="language-c">void *realloc(void *ptr, size_t size)
</code></pre>
<h2>3.内存相关问题</h2>
<ul>
<li>没有申请足够的内存：导致缓冲区溢出(buffer overflow)</li>
<li>忘记初始化分配的内存：导致读取未知数据</li>
<li>忘记释放内存：导致内存泄露(memory leak)</li>
<li>在用完之前释放内存：导致悬挂指针(dangling pointer)</li>
<li>错误的调用 free：导致无效释放(invalid free)</li>
</ul>
<h2>4.地址转换</h2>
<p>物理地址 = 虚拟地址 + 基址</p>
<ul>
<li>进程被创建时，OS必须寻找内存空间</li>
<li>进程被终止时，OS必须回收内存空间</li>
<li>进程切换时，OS要保存和恢复基地址和界限</li>
</ul>

        </main>
    </div>
</body>
</html>