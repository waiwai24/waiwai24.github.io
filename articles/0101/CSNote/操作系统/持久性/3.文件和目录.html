<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># 文件和目录,文件和目录</title>
    <link rel="stylesheet" href="../../../../assets/css/notes.min.css">
</head>
<body>
    <div id="header-placeholder"></div>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>文件和目录</h1>
<h2>1.概念</h2>
<p>目录可以看作一种特殊的文件，目录存在层次结构</p>
<h2>2.文件目录结构</h2>
<ul>
<li>
<p>一级目录结构</p>
</li>
<li>
<p>二级目录结构</p>
</li>
<li>
<p>树形目录结构：</p>
<ul>
<li>任何一级目录中的FCB既可以描述次一级的子目录，又可以描述一个文件</li>
<li>引入当前目录概念(‘.’)，提供相对于当前目录的相对路径名(“…”可以表示上一级目录)加速FCB查找</li>
<li>绝对路径：从根目录开始</li>
<li>相对路径：从当前目录开始</li>
</ul>
</li>
<li>
<p>无环图目录结构：</p>
<ul>
<li>允许目录<strong>共享</strong>子目录和文件</li>
<li>文件可以由多路径访问，便于共享</li>
<li>如果让不同目录包含同一文件FCB的多副本，则一致性难保证，因此将FCB独立存放，引入&lt;文件名/目录名，FCB号&gt;的目录项</li>
<li>引入共享计数器，删除文件时删除该用户的FCB,并使共享计数器减1，计数器为0时删除文件</li>
</ul>
</li>
</ul>
<h2>3.文件目录操作</h2>
<ul>
<li>创建文件：touch filename</li>
<li>读写文件：cat filename</li>
<li>查看文件状态：stat filename</li>
<li>删除文件：rm filename</li>
<li>创建目录 mkdir()</li>
<li>删除目录 rmdir()</li>
<li>打开/关闭目录 opendir()/closedir()</li>
<li>读目录项 readdir()</li>
<li>改名 rename()</li>
</ul>
<h2>4.文件保护</h2>
<p>文件保护系统决定了一个由 主体 对 对象 的特定 访问行为 是否可以执行</p>
<p>访问控制：ACL和Capability</p>
<p>用getfacl查看ACL，用chmod修改权限（rwx）</p>
<p><img src="/0101/CSNote/操作系统/持久性/assets/3.%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95/image-20241201111001290.png" alt="image-20241201111001290"></p>
<h2>5.链接</h2>
<h3>5.1 硬链接</h3>
<p>link 只是在要创建链接的目录中创建了另一个名称，并将其指向原有文件的相同 inode号（即低级别名称）。该文件不以任何方式复制。相反，现在就有了两个人类可读的名称（file 和 file2），都指向同一个文件</p>
<p>调用 unlink()时，会删除人类可读的名称（正在删除的文件）与给定inode 号之间的“链接”，并减少引用计数。只有当引用计数达到零时，文件系统才会释放inode 和相关数据块，从而真正“删除”该文件</p>
<h3>5.2 符号链接</h3>
<p>符号链接（symbolic link），有时称为软链接（softlink）</p>
<p>硬链接有点局限：你不能创建目录的硬链接（因为担心会在目录树中创建一个环）。你不能硬链接到其他磁盘分区中的文件（因为 inode 号在特定文件系统中是唯一的，而不是跨文件系统），等等</p>
<p>符号链接使用相同的程序 ln，但使用-s 标志</p>
<p>与硬链接的区别：</p>
<ul>
<li>
<p>符号链接本身实际上是一个不同类型的文件</p>
<pre><code class="language-shell">prompt&gt; stat file
... regular file ...
prompt&gt; stat file2
... symbolic link ...
</code></pre>
<p>文件最左列中的第一个字符是“-”，目录是“d”，软链接是“l”</p>
<pre><code>prompt&gt; ls -al
drwxr-x--- 2 remzi remzi 29 May 3 19:10 ./
drwxr-x--- 27 remzi remzi 4096 May 3 15:14 ../
-rw-r----- 1 remzi remzi 6 May 3 19:10 file
lrwxrwxrwx 1 remzi remzi 4 May 3 19:10 file2 -&gt; file
</code></pre>
</li>
<li>
<p>形成符号链接的方式，即将链接指向文件的路径名作为链接文件的数据。因为我们链接到一个名为 file 的文件，所以我们的链接文件 file2 很小（4个字节）。如果链接到更长的路径名，链接文件会更大</p>
</li>
<li>
<p>悬空引用（dangling reference），删除名为 file 的原始文件会导致符号链接指向不再存在的路径名</p>
</li>
</ul>

        </main>
    </div>
    <footer class="footer">
        <p>&copy; 2024 waiwai24. All rights reserved.</p>
    </footer>
    <script src="../../../../assets/js/header.js"></script>
    <script src="../../../../assets/js/include-header.js"></script>
</body>
</html>