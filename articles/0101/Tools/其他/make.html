<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title># Make,Make</title>
    <link rel="stylesheet" href="/assets/css/notes.min.css">
</head>
<body>
    <div class="main-content-wrapper">
        <main class="content">
            <h1>Make</h1>
<p>Makefile 文件由一系列规则组成，每条规则形式如下：</p>
<pre><code class="language-makefile">&lt;target&gt; : &lt;prerequisites&gt; 
[tab]  &lt;commands&gt;
</code></pre>
<p>冒号前面的部分，叫做 “目标”（target），冒号后面的部分叫做 “前置条件”（prerequisites）；第二行必须由一个 tab 键起首，后面跟着 “命令”（commands）。“目标” 是必需的，不可省略；“前置条件” 和 “命令” 都是可选的，但是两者之中必须至少存在一个。每条规则就明确两件事：构建目标的前置条件是什么，以及如何构建</p>
<ul>
<li>
<p>target：</p>
<ul>
<li>
<p>通常是文件名，指明 Make 命令所要构建的对象，目标可以是一个文件名，也可以是多个文件名，之间用空格分隔。</p>
</li>
<li>
<p>除了文件名，目标还可以是某个操作的名字，这称为 “伪目标”（phony target）</p>
</li>
<li>
<p>如果 Make 命令运行时没有指定目标，默认会执行 Makefile 文件的第一个目标。</p>
</li>
</ul>
</li>
<li>
<p>prerequisites：</p>
<ul>
<li>通常是一组文件名，之间用空格分隔</li>
<li>只要有一个前置文件不存在，或者有过更新（前置文件的 last-modification 时间戳比目标的时间戳新），target 就需要重新构建</li>
</ul>
</li>
<li>
<p>command：</p>
<ul>
<li>必须以 tab 键开头</li>
</ul>
</li>
</ul>
<p>Makefile 文件语法：</p>
<ul>
<li>井号（#）在 Makefile 中表示注释</li>
<li>允许使用等号自定义变量</li>
<li>内置变量：
<ul>
<li><code>$(CC)</code> 指向当前使用的编译器</li>
<li><code>$(MAKE)</code> 指向当前使用的 Make 工具</li>
</ul>
</li>
<li>自动变量：
<ul>
<li>$@ 指代当前目标，就是 Make 命令当前构建的那个目标</li>
<li>{{CONTENT}}lt; 指代第一个前置条件</li>
<li>$^ 指代所有前置条件</li>
<li><code>$(@D)</code> 和 <code>$(@F)</code> 分别指向 $@ 的目录名和文件名</li>
<li><code>$(&lt;D)</code> 和 <code>$(&lt;F)</code> 分别指向 {{CONTENT}}lt; 的目录名和文件名。</li>
</ul>
</li>
<li>假目标：使用 .PHONY: 关键字来定义</li>
<li>正常情况下，make 会打印每条命令，然后再执行，这就叫做回声（echoing）</li>
<li>命令的前面加上@，就可以关闭回声</li>
<li>通配符用来指定一组符合条件的文件名</li>
<li>模式匹配：允许对文件名，进行类似正则运算的匹配，主要用到的匹配符是%</li>
</ul>

        </main>
    </div>
</body>
</html>