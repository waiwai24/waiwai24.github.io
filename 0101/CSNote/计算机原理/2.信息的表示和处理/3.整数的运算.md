# 整数的运算

> **隐式转换**
>
> c语言在以下几种情况下会进行隐式转换
>
> > 1、算术运算式中，低类型能够转换为高类型。
> >
> > ​    例：int + char +double运算的结果应该为double类型
> >
> > 2、赋值表达式中，右边表达式的值自动隐式转换为左边变量的类型，并赋值给他。
> >
> > ​    例：int = float + char,表达式的右边char 类型和float类型进行运算进行隐式转换为float类型，在将float类型转换为int类型赋值给表达式左边的int类型变量。
> >
> > 3、函数调用中参数传递时，系统隐式地将实参转换为形参的类型后，赋给形参。
> >
> > 4、函数有返回值时，系统将隐式地将返回表达式类型转换为返回值类型，赋值给调用函数。
>
> **2.算术运算的隐式转换**
>
> 转换规则如下
>
> > 1、字符必须先转换为整数(C语言规定字符类型数据和整型数据之间可以通用) 。
> >
> > 2、short型转换为int型(同属于整型) 。
> >
> > 3、float型数据在运算时一律转换为双精度(double)型，以提高运算精度(同属于实型) 。其次，有下面的规则。
> >
> > 同时，算术运算中不同类型之间的运算也遵循隐式转换规则和整型提升规则。

## 1.无符号整数的加法

溢出：运算结果不能放到数据类型的字长限制中（最高位有进位就溢出了）



## 2.有符号整数的加法

**补码加法溢出：（符号位参与运算）**
$$
[A+B]_{补}=[A]_{补}+[B]_{补}
$$

* 正溢出：两正数相加，得到非正
* 负溢出：两负数相加，得到非负



溢出的机器检测：

* 补码采用两位符号位（变形补码）
* 符号位仍参与运算，结果中两位符号标识溢出状态（符号位相同正常，01正溢出，10负溢出）



## 3.有符号整数的减法

补码表示法可以将减法变成加法
$$
[A - B]_{补}＝[A]_{补} + [-B]_{补}
$$



## 4.整数的乘法

乘法器的实现：移位累加乘法器、查询表乘法器、阵列乘法器、Booth 乘法器、Wallace树型乘法器……



## 5.整数的逻辑运算和按位运算

### 5.1 位操作

* `&`：按位与：两个位都为1时结果才为1
* `|`：按位或：两个位都为0时结果才为0
* `~`：按位取反：0变1，1变0
* `^`：按位异或：相同为0，相异为1
* `<<`：左移：高位丢弃。低位补0
* `>>`：右移：对于无符号数高位补0，对于有符号数各编译器的处理方法不太一样，有的补符号位（算术右移），有的补0（逻辑右移）

### 5.2 逻辑运算

* `&&`：逻辑与and
* `||`逻辑或or
* `!`：逻辑非not

### 5.3 掩码

掩码是一串二进制代码对目标字段进行**位运算** ，**屏蔽部分输入位**



例：对于任意变量S，如何获得S的最低有效字节？ 

如S = 0x89ABCDEF， 则S & 0xFF = 0x000000EF
