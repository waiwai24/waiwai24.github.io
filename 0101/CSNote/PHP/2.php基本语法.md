# php基本语法

[TOC]

## 1. 基本格式

PHP 脚本可以放在文档中的任何位置。

PHP 脚本以 **<?php** 开始，以 **?>** 结束：

```php
<?php
// PHP 代码
?>
```

PHP 文件的默认文件扩展名是 **.php**。

PHP 文件通常包含 HTML 标签和一些 PHP 脚本代码。

### 1.1 注释

```php
<!DOCTYPE html>
<html>
<body><?php
// 这是 PHP 单行注释
/*
这是 
PHP 多行
注释
*/
?>
</body>
</html>
```

### 1.2 输出

在 PHP 中有两个基本的输出方式： echo 和 print

echo 和 print 区别:

- echo - 可以输出一个或多个字符串。
- print - 只允许输出一个字符串，返回值总为 1。

echo是经常用的，一般用于回显，比如sql注入时回显查询语句结果

**提示：**echo 输出的速度比 print 快， echo 没有返回值，print有返回值1

### 1.3 变量

PHP 变量规则：

- 变量以 $ 符号开始，后面跟着变量的名称
- 变量名必须以字母或者下划线字符开始
- 变量名只能包含字母数字字符以及下划线（A-z、0-9 和 _ ）
- 变量名不能包含空格
- 变量名是区分大小写的(PHP 语句和 PHP 变量都是区分大小写的)

```php
<?php
$x=5;
$y=6;
$z=$x+$y;
echo $z;

$txt="Hello world!";
//赋一个文本值给变量时，在文本值两侧加上引号
?>
```

php是弱类型语言，不用在变量前面加类型，PHP 会根据变量的值，自动把变量转换为正确的数据类型。从学安全的角度，能看懂哪个是变量就ok了，如果以后学的更深入了，需要使用php来写POC，进行持续性漏洞再回过头来学习命名规则等

#### 1.3.1 弱类型安全

php中有一些相等的值

- ''== 0 == false ==NULL
- '123'==123
- 'abc'==0
- '123a'==123
- '0x01'==1
- '0e123456789'=='0e987654321'
- [false] == [0] == [NULL] == ['']
- true == 1

在PHP中，比较两个值是否相等可以使用“ == ”或“===”，前者会自动进行类型转换

- 松散比较：使用两个等号 **==** 比较，只比较值，不比较类型
- 严格比较：用三个等号 **===** 比较，除了比较值，也比较类型

```php
<?php
$input = "1abc";
if($input==1)
{
	echo "flag";
}
?>
//输出flag
```

#### 1.3.2 变量作用域

变量的作用域是脚本中变量可被引用/使用的部分。

PHP 有四种不同的变量作用域：

- local局部
- global全局：
  - global 关键字用于函数内访问全局变量
  - 在函数内调用函数外定义的全局变量，我们需要在函数中的变量前加上 global 关键字

- static：
  - 当一个函数完成时，它的所有变量通常都会被删除。然而，有时候希望某个局部变量不要被删除，要做到这一点，请在您第一次声明变量时使用 **static** 关键字
- parameter：
  - 参数是通过调用代码将值传递给函数的局部变量。参数是在参数列表中声明的，作为函数声明的一部分

### 1.4 EOF

PHP EOF(heredoc)是一种在命令行shell（如sh、csh、ksh、bash、PowerShell和zsh）和程序语言（像Perl、PHP、Python和Ruby）里定义一个字符串的方法。

使用概述：

- 必须后接分号，否则编译通不过。
- **EOF** 可以用任意其它字符代替，只需保证结束标识与开始标识一致。开始标记和结束标记相同，比如常用大写的 **EOT、EOD、EOF** 来表示，但是不只限于那几个(也可以用：JSON、HTML等)，只要保证开始标记和结束标记不在正文中出现即可
- **结束标识必须顶格独自占一行(即必须从行首开始，前后不能衔接任何空白和字符)。**
- 开始标识可以不带引号或带单双引号，不带引号与带双引号效果一致，解释内嵌的变量和转义符号，带单引号则不解释内嵌的变量和转义符号。
- 当内容需要内嵌引号（单引号或双引号）时，不需要加转义符，本身对单双引号转义，此处相当与q和qq的用法。

```php+HTML
<?php
echo <<<EOF

    <h1>我的第一个标题</h1>
    <p>我的第一个段落。</p>

EOF;
//以 <<<EOF 开始标记开始，以 EOF 结束标记结束，结束标记必须顶头写，不能有缩进和空格，且在结束标记末尾要有分号
?>
```



## 二.数据类型

PHP 支持以下几种数据类型:

- String（字符串）
- Integer（整型）
- Float（浮点型）
- Boolean（布尔型）
- Array（数组）
- Object（对象）
- NULL（空值）
- Resource（资源类型）

**var_dump()** 函数用于输出变量的相关信息

### 2.1 字符串

- 一个字符串是一串字符的序列，就像 "Hello world!"。
- 你可以将任何文本放在单引号和双引号中

#### 2.1.1 并置运算符

- 在 PHP 中，只有一个字符串运算符
- 并置运算符 (.) 用于把两个字符串值连接起来

#### 2.1.2 strlen() 函数

strlen() 函数返回字符串的长度（字节数）

#### 2.1.3 strpos() 函数

- strpos() 函数用于在字符串内查找一个字符或一段指定的文本。
- 如果在字符串中找到匹配，该函数会返回第一个匹配的字符位置。如果未找到匹配，则返回 FALSE

```php
<?php
echo strpos("Hello world!","world");
?>
   
运行结果：6
字符串 "world" 的位置是 6。之所以是 6 而不是 7 的原因是，字符串中第一个字符的位置是 0，而不是 1
```



### 2.2 整型

整数规则:

- 整数不能包含逗号或空格
- 整数是没有小数点的
- 整型可以用三种格式来指定：十进制， 十六进制（ 以 0x 为前缀）或八进制（前缀为 0）

### 2.3 浮点型

浮点数是带小数部分的数字，或是指数形式

### 2.4 布尔型

布尔型可以是 TRUE 或 FALSE

### 2.5 数组

数组可以在一个变量中存储多个值

```php
<!DOCTYPE html>
<html>
<body>

<?php 
$cars=array("Volvo","BMW","Toyota");
var_dump($cars);
?>   

</body>
</html>
    
运行结果：
array(3) { [0]=> string(5) "Volvo" [1]=> string(3) "BMW" [2]=> string(6) "Toyota" }
```

### 2.6 对象

- 对象数据类型也可以用于存储数据。
- 在 PHP 中，对象必须声明。
- 首先，你必须使用class关键字声明类对象。类是可以包含属性和方法的结构。
- 然后我们在类中定义数据类型，然后在实例化的类中使用数据类型

### 2.7 NULL值

- NULL 值表示变量没有值。NULL 是数据类型为 NULL 的值。
- NULL 值指明一个变量是否为空值。 同样可用于数据空值和NULL值的区别。
- 可以通过设置变量值为 NULL 来清空变量数据

### 2.8 资源类型

- PHP 资源 resource 是一种特殊变量，保存了到外部资源的一个引用
- 常见资源数据类型有打开文件、数据库连接、图形画布区域等
- 由于资源类型变量保存有为打开文件、数据库连接、图形画布区域等的特殊句柄，因此将其它类型的值转换为资源没有意义

```php
<?php
$c = mysql_connect();
echo get_resource_type($c)."\n";
// 打印：mysql link

$fp = fopen("foo","w");
echo get_resource_type($fp)."\n";
// 打印：file

$doc = new_xmldoc("1.0");
echo get_resource_type($doc->doc)."\n";
// 打印：domxml document
?>
```



## 三. 常量

常量值被定义后，常量在定义后，默认是全局变量，在脚本的其他任何地方都不能被改变，==常量名不需要加 $ 修饰符==

### 3.1 设置常量

设置常量，使用 define() 函数，函数语法如下：

```php
bool define ( string $name , mixed $value [, bool $case_insensitive = false ] )
```

- **name：**必选参数，常量名称，即标志符。

- **value：**必选参数，常量的值。

- **case_insensitive** ：可选参数，如果设置为 TRUE，该常量则大小写不敏感，默认是大小写敏感的。

  **注意：**自 PHP 7.3.0 开始，定义不区分大小写的常量已被弃用。从 PHP 8.0.0 开始，只有 false 是可接受的值，传递 true 将产生一个警告。

### 3.2 常量是全局的



## 四. 运算符

### 4.1 算数运算符

| 运算符 | 名称             | 描述                                                         | 实例                         | 结果  |
| :----- | :--------------- | :----------------------------------------------------------- | :--------------------------- | :---- |
| x + y  | 加               | x 和 y 的和                                                  | 2 + 2                        | 4     |
| x - y  | 减               | x 和 y 的差                                                  | 5 - 2                        | 3     |
| x * y  | 乘               | x 和 y 的积                                                  | 5 * 2                        | 10    |
| x / y  | 除               | x 和 y 的商                                                  | 15 / 5                       | 3     |
| x % y  | 模（除法的余数） | x 除以 y 的余数                                              | 5 % 2 10 % 8 10 % 2          | 1 2 0 |
| -x     | 设置负数         | 取 x 的相反符号                                              | `<?php $x = 2; echo -$x; ?>` | -2    |
| ~x     | 取反             | x 取反，按二进制位进行"取反"运算。运算规则：`~1=-2;    ~0=-1;` | `<?php $x = 2; echo ~$x; ?>` | -3    |
| a . b  | 并置             | 连接两个字符串                                               | "Hi" . "Ha"                  | HiHa  |

### 4.2 赋值运算符

基本的赋值运算符是 **=**。它意味着左操作数被设置为右侧表达式的值

| 运算符 | 等同于    | 描述                           |
| :----- | :-------- | :----------------------------- |
| x = y  | x = y     | 左操作数被设置为右侧表达式的值 |
| x += y | x = x + y | 加                             |
| x -= y | x = x - y | 减                             |
| x *= y | x = x * y | 乘                             |
| x /= y | x = x / y | 除                             |
| x %= y | x = x % y | 模（除法的余数）               |
| a .= b | a = a . b | 连接两个字符串                 |

### 4.3 递增/递减运算符

| 运算符 | 名称   | 描述                |
| :----- | :----- | :------------------ |
| ++ x   | 预递增 | x 加 1，然后返回 x  |
| x ++   | 后递增 | 返回 x，然后 x 加 1 |
| -- x   | 预递减 | x 减 1，然后返回 x  |
| x --   | 后递减 | 返回 x，然后 x 减 1 |

### 4.4 比较运算符

| 运算符  | 名称       | 描述                                           | 实例               |
| :------ | :--------- | :--------------------------------------------- | :----------------- |
| x == y  | 等于       | 如果 x 等于 y，则返回 true                     | 5==8 返回 false    |
| x === y | 绝对等于   | 如果 x 等于 y，且它们类型相同，则返回 true     | 5==="5" 返回 false |
| x != y  | 不等于     | 如果 x 不等于 y，则返回 true                   | 5!=8 返回 true     |
| x <> y  | 不等于     | 如果 x 不等于 y，则返回 true                   | 5<>8 返回 true     |
| x !== y | 不绝对等于 | 如果 x 不等于 y，或它们类型不相同，则返回 true | 5!=="5" 返回 true  |
| x > y   | 大于       | 如果 x 大于 y，则返回 true                     | 5>8 返回 false     |
| x < y   | 小于       | 如果 x 小于 y，则返回 true                     | 5<8 返回 true      |
| x >= y  | 大于等于   | 如果 x 大于或者等于 y，则返回 true             | 5>=8 返回 false    |
| x <= y  | 小于等于   | 如果 x 小于或者等于 y，则返回 true             | 5<=8 返回 true     |

### 4.5 逻辑运算符

| 运算符   | 名称 | 描述                                         | 实例                                 |
| :------- | :--- | :------------------------------------------- | :----------------------------------- |
| x and y  | 与   | 如果 x 和 y 都为 true，则返回 true           | x=6 y=3 (x < 10 and y > 1) 返回 true |
| x or y   | 或   | 如果 x 和 y 至少有一个为 true，则返回 true   | x=6 y=3 (x== 6 or y==5) 返回 true    |
| x xor y  | 异或 | 如果 x 和 y 有且仅有一个为 true，则返回 true | x=6 y=3 (x== 6 xor y==3) 返回 false  |
| x && y   | 与   | 如果 x 和 y 都为 true，则返回 true           | x=6 y=3 (x < 10 && y > 1) 返回 true  |
| x \|\| y | 或   | 如果 x 和 y 至少有一个为 true，则返回 true   | x=6 y=3 (x== 5 \|\| y==5) 返回 false |
| ! x      | 非   | 如果 x 不为 true，则返回 true                | x=6 y=3 !(x==y) 返回 true            |

### 4.6 数组运算符

| 运算符  | 名称   | 描述                                                         |
| :------ | :----- | :----------------------------------------------------------- |
| x + y   | 集合   | x 和 y 的集合                                                |
| x == y  | 相等   | 如果 x 和 y 具有相同的键/值对，则返回 true                   |
| x === y | 恒等   | 如果 x 和 y 具有相同的键/值对，且顺序相同类型相同，则返回 true |
| x != y  | 不相等 | 如果 x 不等于 y，则返回 true                                 |
| x <> y  | 不相等 | 如果 x 不等于 y，则返回 true                                 |
| x !== y | 不恒等 | 如果 x 不等于 y，则返回 true                                 |

### 4.7 三元运算符

```php
(expr1) ? (expr2) : (expr3) 
```

* 对 expr1 求值为 TRUE 时的值为 expr2，在 expr1 求值为 FALSE 时的值为 expr3
* 自 PHP 5.3 起，可以省略三元运算符中间那部分。表达式 expr1 ?: expr3 在 expr1 求值为 TRUE 时返回 expr1，否则返回 expr3
* 在 PHP7+ 版本多了一个 NULL 合并运算符 **??**

```php
<?php
// 如果 $_GET['user'] 不存在返回 'nobody'，否则返回 $_GET['user'] 的值
$username = $_GET['user'] ?? 'nobody';
// 类似的三元运算符
$username = isset($_GET['user']) ? $_GET['user'] : 'nobody';
?>
```

### 4.8 组合比较符

PHP7+ 支持组合比较符（combined comparison operator）也称之为太空船操作符，符号为 **<=>**。组合比较运算符可以轻松实现两个变量的比较，当然不仅限于数值类数据的比较

```php
$c = $a <=> $b;
```

解析如下：

- 如果 **\$a > $b**, 则 **$c** 的值为 **1**。
- 如果 **\$a == $b**, 则 **$c** 的值为 **0**。
- 如果 **\$a < $b**, 则 **$c** 的值为 **-1**。
