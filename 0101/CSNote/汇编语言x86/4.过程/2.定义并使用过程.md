# 定义并使用过程

> 一个程序会被分割成若干子过程（subroutine），在汇编语言中，通常用过程（procedure）来代指这些子过程的程序，在其他语言中，子程序也被称为方法或者函数



## 1.PROC伪指令

* 过程的非正式定义：由返回语句结束的已命名语句块

* 过程用PROC和ENDP伪指令来定义，并且必须为其分配一个名字（有效标识符）

  ```assembly
  main PROC
  .
  .
  main ENDP
  ```

  

## 2.CALL，RET指令

* CALL：

  * 指令调用一个过程，指挥处理器从一个新地址开始执行
  * 先将返回地址压入堆栈，`ESP-4`,再把被调用的地址复制到`EIP`

* RET:

  * 指令将处理器转回到该过程被调用的程序点上
  * 从堆栈中把返回地址弹回到`EIP`，同时`ESP+4`

    ```
    ret:(return)默认retn
    retn:return near=pop eip，近跳转
    retf: return far=pop eip;pop cs，远跳转 
    ```
  * retn 16：

    - `retn 16` 中的 `16` 是一个立即数参数，表示从栈上移除的字节数。
    - 当执行 `retn 16` 指令时，除了将控制权返回到调用者之外，还会从栈上移除 `16` 字节的数据。这通常用于清理函数调用时压入栈的参数。

  
