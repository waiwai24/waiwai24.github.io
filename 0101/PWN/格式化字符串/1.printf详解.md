# printf 详解

> fprintf -- 打印到 FILE 流
>
> printf -- 打印到 stdout 流
>
> sprintf -- 打印到字符串
>
> snprintf -- 打印到字符串，带有长度检查
>
> vfprintf -- 从 va_arg 结构打印到 FILE 流
>
> vprintf -- 从 va_arg 结构打印到 stdout 流
>
> vsprintf -- 从 va_arg 结构打印到字符串
>
> vsnprintf -- 从 va_arg 结构打印到字符串，带有长度检查

## 1.调用格式

```
printf("<格式化字符串>", <参量表>);
```



## 2.格式化字符串中转换规则

```
%[parameter][flags][field width][.precision][length]type
```

一个基本的转换规范仅包含百分号和一个类型字符。 例如，`%s` 指定一个字符串转换。 若要打印百分号字符，请使用 `%%`。 如果百分号后跟一个没有任何意义的字符作为格式字段，则将调用无效的参数处理程序

* parameter 参数：`n$`, 用来获取格式化字符串中指定参数
* flag：width 设置后指定可以用来作为填充的内容
* field width：输出最小宽度
* precision：输出的最大长度
* length：输出的长度, hh, h, l, ll
* type



## 3.Type

| 类型字符 | 参数           | 输出格式                                                     |
| -------- | -------------- | ------------------------------------------------------------ |
| ==c==    | 字符           | 与 `printf` 函数一起使用时，指定单字节字符；与 `wprintf` 函数一起使用时，指定宽字符。 |
| **`C`**  | 字符           | 与 `printf` 函数一起使用时，指定宽字符；与 `wprintf` 函数一起使用时，指定单字节字符。 |
| ==d==    | Integer        | 带符号十进制整数。                                           |
| **`i`**  | Integer        | 带符号十进制整数。                                           |
| **`o`**  | Integer        | 无符号八进制整数。                                           |
| **`u`**  | Integer        | 无符号十进制整数。                                           |
| ==x==    | Integer        | 无符号十六进制整数；使用“`abcdef`”。                         |
| **`X`**  | Integer        | 无符号十六进制整数；使用“`ABCDEF`”。                         |
| **`e`**  | 浮点           | 有符号的值，形式为 [`-`] *d.dddd* `e`[`+`                      |
| **`E`**  | 浮点           | 与 **`e`** 格式相同，除非 **`E`**（而非 **`e`**）引入了指数。 |
| **`f`**  | 浮点           | 有符号的值，形式为 [`-`] *dddd* `.` *dddd*，其中 *dddd* 是一个或多个十进制数。 小数点前的数字位数取决于数字的度量值，小数点后的数字位数取决于请求的精度，或为默认的六位数。 |
| **`F`**  | 浮点           | 与 **`f`** 格式相同，只不过 infinity 和 NAN 输出为大写形式。 |
| **`g`**  | 浮点           | 有符号的值显示为 **`f`** 或 **`e`** 格式，取其中对于给定的值和精度更为精简一个。 仅当值的指数小于 -4 或大于等于 precision 参数时，才使用 **`e`** 格式。 截去尾随零，仅当后跟一个或多个数字时，才会显示小数点。 |
| **`G`**  | 浮点           | 与 **`g`** 格式相同，除非 **`E`**（而非 **`e`**）引入指数（如果适用）。 |
| **`a`**  | 浮点           | 有符号的十六进制双精度浮点值，形式为 [`-`] `0x` *h.hhhh* `p`[`+` |
| **`A`**  | 浮点           | 有符号的十六进制双精度浮点值，形式为 [`-`] `0X` *h.hhhh* `P`[`+` |
| ==n==    | 指向整数的指针 | 不输出字符，但是把已经成功输出的字符个数写入对应的整型指针参数所指的变量。 |
| ==p==    | 指针类型       | 将自变量显示为十六进制数中的地址。printf("%p", a) 用地址的格式打印变量 a 的值，printf("%p", &a) 打印变量 a 所在的地址。 |
| ==s==    | 字符串         | 与 `printf` 函数一起使用时，指定单字节或多字节字符串；与 `wprintf` 函数一起使用时，指定宽字符字符串。 将于第一个空字符之前或达到精度值时显示字符。 |
| **`S`**  | 字符串         | 与 `printf` 函数一起使用时，指定宽字符字符串；与 `wprintf` 函数一起使用时，指定单字节或多字节字符串。 将于第一个空字符之前或达到精度值时显示字符。 |



## 4.flag

| flags（标识） | 描述                                                         |
| ------------- | ------------------------------------------------------------ |
| -             | 在给定的字段宽度内左对齐，默认是右对齐（参见 width 子说明符）。 |
| +             | 强制在结果之前显示加号或减号（+ 或 -），即正数前面会显示 + 号。默认情况下，只有负数前面会显示一个 - 号。 |
| 空格          | 如果没有写入任何符号，则在该值前面插入一个空格。             |
| #             | 与 o、x 或 X 说明符一起使用时，非零值前面会分别显示 0、0x 或 0X。  与 e、E 和 f 一起使用时，会强制输出包含一个小数点，即使后边没有数字时也会显示小数点。默认情况下，如果后边没有数字时候，不会显示显示小数点。  与 g 或 G 一起使用时，结果与使用 e 或 E 时相同，但是尾部的零不会被移除。 |



## 5.field width

| width（宽度） | 描述                                                         |
| ------------- | ------------------------------------------------------------ |
| (number)      | 要输出的字符的最小数目。如果输出的值短于该数，结果会用空格填充。如果输出的值长于该数，结果不会被截断。 |



## 6.precision

| .precision（精度） | 描述                                                         |
| ------------------ | ------------------------------------------------------------ |
| .number            | 对于整数说明符（d、i、o、u、x、X）：precision 指定了要写入的数字的最小位数。如果写入的值短于该数，结果会用前导零来填充。如果写入的值长于该数，结果不会被截断。精度为 0 意味着不写入任何字符。  对于 e、E 和 f 说明符：要在小数点后输出的小数位数。  对于 g 和 G 说明符：要输出的最大有效位数。  对于 s: 要输出的最大字符数。默认情况下，所有字符都会被输出，直到遇到末尾的空字符。  对于 c 类型：没有任何影响。  当未指定任何精度时，默认为 1。如果指定时不带有一个显式值，则假定为 0。 |



## 7.length

* `hh`：输出 1byte
* `h`：输出 2byte
* `l`：输出 4byte
* `ll`：输出 8byte



## 8.常见使用

* `%<正整数n>c`：打印宽度为 n 的字符串，其余部分前面补空格
* `%lln`: 将当前已打印字符个数（8 字节）写入参数地址处
* `%n`：将当前已打印字符个数（4 字节）写入参数地址处
* `%hn`：将当前已打印字符个数（2 字节）写入参数地址处
* `%hhn`：将当前已打印字符个数（1 字节）写入参数地址处
* `%<正整数n>$<fmt>`：指定占位符对应第 n 个参数

