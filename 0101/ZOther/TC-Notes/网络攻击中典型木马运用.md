# 网络攻击中典型木马运用

> 2024.04.23
>
> 无花果，灰鸽子，广外女生，毒药，海龙



## 1.木马的概念

远控

通常两个程序：控制端，被控制端



## 2.分类

### 2.1 从架构设计

* C/S模式：client，server，被控端从有界面变成无界面，木马程序从有进程到无进程
* B/S模式：browser
* 云木马：异步通信木马
* 驱动木马：驱动层通信程序开发（底层）

### 2.2 从应用场景

* 前锋马：功能单一，仅完成下载执行功能（美国知名木马PI，常驻内存）
* 控守马：也叫功能马，对网路目标进行长期的控守，使用频率高，代码量大
* 潜伏马：前两种马掉线后，通过潜伏马再把目标重新连接出来
* 代理马：终端连接互联网不仅仅要走代理服务器还需要有身份认证
* 桥接马：解决数据包的代理转发

### 2.3 从连接方式

* 直连马
* 反弹马：也叫反连马，控制端主动开启监听端口
* 异步马：非实时



## 3.木马开发关键技术

### 3.1 通信技术

* TCP协议马
  * 传统协议木马
  * 基于socks协议族
  * 采取C/S模式设计架构
* http/https协议马
* DNS协议马

### 3.2 启动技术

* startup启动（startup目录）
* 注册表启动（系统注册表键位）
* 利用漏洞捆绑启动
* 系统劫持启动
* “白加黑”启动
* 病毒感染文件启动
* 系统服务启动

### 3.3 隐藏技术

* 驱动隐藏
* 系统文件替换隐藏
* 文件分片重组隐藏
* 文件不落地隐藏运行